!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("react"),require("baconjs"),require("infestines")):"function"==typeof define&&define.amd?define(["exports","react","baconjs","infestines"],n):n(r.baret=r.baret||{},r.React,r.Bacon,r.I)}(this,function(r,n,e,i){"use strict";function t(r,n,e){if(j(r))return e[++n[0]];if(i.isArray(r)){for(var s=r,u=0,a=r.length;u<a;++u){var l=r[u],o=l;j(l)?o=e[++n[0]]:i.isArray(l)&&(o=t(l,n,e)),o!==l&&(s===r&&(s=r.slice(0)),s[u]=o)}return s}return r}function s(r,n,e){var i=void 0;for(var t in r){var s=r[t];if(j(s)){if(!i){i={};for(var u in r){if(u===t)break;i[u]=r[u]}}i[t]=e[++n[0]]}else i&&(i[t]=s)}return i||r}function u(r,n){var e=null,i=null,u=null,a=[-1];for(var l in r){var o=r[l];m===l?u=t(o,a,n):"$$type"===l?e=r[l]:g===l?(i=i||{},i.ref=j(o)?n[++a[0]]:o):j(o)?(i=i||{},i[l]=n[++a[0]]):y===l?(i=i||{},i.style=s(o,a,n)||o):(i=i||{},i[l]=o)}return u instanceof Array?U.apply(null,[e,i].concat(u)):u?U(e,i,u):U(e,i)}function a(r,n,e){for(var t=0,s=r.length;t<s;++t){var u=r[t];j(u)?e(n,u):i.isArray(u)&&a(u,n,e)}}function l(r,n,e){for(var t in r){var s=r[t];if(j(s))e(n,s);else if(m===t)i.isArray(s)&&a(s,n,e);else if(y===t)for(var u in s){var l=s[u];j(l)&&e(n,l)}}}function o(r){r.values+=1}function f(r,n){r.unsub=n.subscribe(r)}function c(r,n){var e=function n(e){for(var i=r.handlers,t=0;i[t]!==n;)++t;if(e.hasValue()){var s=e.value(),u=r.values;u[t]!==s&&(u[t]=s,r.forceUpdate())}else{if(e.isError())throw e.error;i[t]=null;var a=i.length;if(a!==r.values.length)return;for(var l=0;l<a;++l)if(i[l])return;r.handlers=null}};r.handlers.push(e),e.unsub=n.subscribe(e)}function h(r){r&&r.unsub()}function v(r,n){for(var e=n.length;r<e;++r){var t=n[r];if(j(t)||i.isArray(t)&&v(0,t))return!0}return!1}function d(r){for(var n in r){var e=r[n];if(j(e))return!0;if(m===n){if(i.isArray(e)&&v(0,e))return!0}else if(y===n)for(var t in e)if(j(e[t]))return!0}return!1}function b(r,n){var e={$$type:r};for(var i in n){var t=n[i];"ref"===i?e[g]=t:A!==i&&(e[i]=t)}return e}function p(){for(var r=arguments.length,n=Array(r),e=0;e<r;e++)n[e]=arguments[e];var t=n[0],s=n[1]||i.object0;return(i.isString(t)||s[A])&&(v(2,n)||d(s)?(n[1]=b(t,s),n[0]=k):s[A]&&(n[1]=i.dissocPartialU(A,s)||i.object0)),U.apply(void 0,n)}n="default"in n?n.default:n;var y="style",m="children",A="baret-lift",g="$$ref",U=n.createElement,E=n.Component,j=function(r){return r instanceof e.Observable},$=i.inherit(function(r){E.call(this,r)},E,{componentWillReceiveProps:function(r){this.componentWillUnmount(),this.doSubscribe(r)},componentWillMount:function(){this.doSubscribe(this.props)}}),S=i.inherit(function(r){$.call(this,r),this.callback=null,this.rendered=null},$,{componentWillUnmount:function(){this.unsub&&this.unsub()},doSubscribe:function(r){var n=this,e=r.observable;if(j(e)){var i=function(r){if(r.hasValue())n.rendered=r.value()||null,n.forceUpdate();else{if(r.isError())throw r.error;r.isEnd()&&(n.unsub=null)}};this.unsub=e.subscribe(i)}else this.rendered=e||null},render:function(){return this.rendered}}),W=function(r){return U(S,{observable:r})},k=i.inherit(function(r){$.call(this,r),this.values=this,this.handlers=null},$,{componentWillUnmount:function(){var r=this.handlers;r instanceof Function?r.unsub():r&&r.forEach(h)},doSubscribe:function(r){var n=this;this.values=0,l(r,this,o);var e=this.values;switch(e){case 0:this.values=i.array0;break;case 1:this.values=this;var t=function(r){if(r.hasValue()){var e=r.value();n.values!==e&&(n.values=e,n.forceUpdate())}else{if(r.isError())throw r.error;n.values=[n.values],n.handlers=null}};this.handlers=t,l(r,t,f);break;default:this.values=Array(e).fill(this),this.handlers=[],l(r,this,c)}},render:function(){if(this.handlers instanceof Function){var r=this.values;return r===this?null:u(this.props,[r])}for(var n=this.values,e=0,i=n.length;e<i;++e)if(n[e]===this)return null;return u(this.props,n)}}),w=i.assocPartialU("createElement",p,n),P=function(r){return function(n){return U(k,b(r,n))}};r.fromBacon=W,r.default=w,r.fromClass=P,Object.defineProperty(r,"__esModule",{value:!0})});
