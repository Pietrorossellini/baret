!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("baconjs"),require("infestines")):"function"==typeof define&&define.amd?define(["exports","react","baconjs","infestines"],e):e(r.baret=r.baret||{},r.React,r.Bacon,r.I)}(this,function(r,e,n,i){"use strict";function t(r){$.call(this,r)}function s(r){t.call(this,r),this.callback=null,this.rendered=null}function a(r,e,n){for(var t in r){var s=r[t];if(j(s))n(e,s);else if(g===t){if(i.isArray(s))for(var a=0,u=s.length;a<u;++a){var l=s[a];j(l)&&n(e,l)}}else if(m===t)for(var o in s){var f=s[o];j(f)&&n(e,f)}}}function u(r,e){var n=null,t=null,s=null,a=-1;for(var u in r){var l=r[u];if(g===u)if(j(l))s=e[++a];else if(i.isArray(l)){for(var o=0,f=l.length;o<f;++o){var c=l[o];if(j(c)){if(!s){s=Array(f);for(var h=0;h<o;++h)s[h]=l[h]}s[o]=e[++a]}else s&&(s[o]=c)}s||(s=l)}else s=l;else if("$$type"===u)n=r[u];else if(A===u)t=t||{},t.ref=j(l)?e[++a]:l;else if(j(l))t=t||{},t[u]=e[++a];else if(m===u){var v=void 0;for(var d in l){var b=l[d];if(j(b)){if(!v){v={};for(var p in l){if(p===d)break;v[p]=l[p]}}v[d]=e[++a]}else v&&(v[d]=b)}t=t||{},t.style=v||l}else t=t||{},t[u]=l}return s instanceof Array?E.apply(null,[n,t].concat(s)):s?E(n,t,s):E(n,t)}function l(r){r.values+=1}function o(r,e){r.unsub=e.subscribe(r)}function f(r,e){var n=function e(n){return r.doHandleN(e,n)};r.handlers.push(n),n.unsub=e.subscribe(n)}function c(r){r&&r.unsub()}function h(r){t.call(this,r),this.values=this,this.handlers=null}function v(r){for(var e in r){var n=r[e];if(j(n))return!0;if(g===e){if(i.isArray(n))for(var t=0,s=n.length;t<s;++t)if(j(n[t]))return!0}else if(m===e)for(var a in n)if(j(n[a]))return!0}return!1}function d(r){for(var e=2,n=r.length;e<n;++e){var t=r[e];if(i.isArray(t)){for(var s=0,a=t.length;s<a;++s)if(j(t[s]))return!0}else if(j(t))return!0}return v(r[1])}function b(r,e){var n={$$type:r};for(var i in e){var t=e[i];"ref"===i?n[A]=t:U!==i&&(n[i]=t)}return n}function p(r){return r&&!0===r[U]}function y(){for(var r=arguments.length,e=Array(r),n=0;n<r;n++)e[n]=arguments[n];var t=e[0],s=e[1];return(i.isString(t)||p(s))&&(d(e)?(e[1]=b(t,s),e[0]=h):p(s)&&(e[1]=i.dissocPartialU(U,s)||i.object0)),E.apply(void 0,e)}e="default"in e?e.default:e;var m="style",g="children",U="baret-lift",A="$$ref",E=e.createElement,$=e.Component,j=function(r){return r instanceof n.Observable};i.inherit(t,$,{componentWillReceiveProps:function(r){this.doUnsubscribe(),this.doSubscribe(r)},componentWillMount:function(){this.doSubscribe(this.props)},componentWillUnmount:function(){this.doUnsubscribe()}}),i.inherit(s,t,{doUnsubscribe:function(){this.unsub&&this.unsub()},doSubscribe:function(r){var e=this,n=r.observable;if(j(n)){var i=function(r){if(r.hasValue())e.rendered=r.value()||null,e.forceUpdate();else{if(r.isError())throw r.error;r.isEnd()&&(e.unsub=null)}};this.unsub=n.subscribe(i)}else this.rendered=n||null},render:function(){return this.rendered}});var S=function(r){return E(s,{observable:r})};i.inherit(h,t,{doUnsubscribe:function(){var r=this.handlers;r instanceof Function?r.unsub():r&&r.forEach(c)},doSubscribe:function(r){var e=this;this.values=0,a(r,this,l);var n=this.values;switch(n){case 0:this.values=i.array0;break;case 1:this.values=this;var t=function(r){return e.doHandle1(r)};this.handlers=t,a(r,t,o);break;default:this.values=Array(n).fill(this),this.handlers=[],a(r,this,f)}},doHandle1:function(r){if(r.hasValue()){var e=r.value();this.values!==e&&(this.values=e,this.forceUpdate())}else{if(r.isError())throw r.error;this.values=[this.values],this.handlers=null}},doHandleN:function(r,e){for(var n=this.handlers,i=0;n[i]!==r;)++i;if(e.hasValue()){var t=e.value(),s=this.values;s[i]!==t&&(s[i]=t,this.forceUpdate())}else{if(e.isError())throw e.error;n[i]=null;var a=n.length;if(a!==this.values.length)return;for(var u=0;u<a;++u)if(n[u])return;this.handlers=null}},render:function(){if(this.handlers instanceof Function){var r=this.values;return r===this?null:u(this.props,[r])}for(var e=this.values,n=0,i=e.length;n<i;++n)if(e[n]===this)return null;return u(this.props,e)}});var k=i.assocPartialU("createElement",y,e),w=function(r){return function(e){return E(h,b(r,e))}};r.fromBacon=S,r.default=k,r.fromClass=w,Object.defineProperty(r,"__esModule",{value:!0})});
